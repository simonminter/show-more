!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ShowMore=t()}(this,(function(){"use strict";const e=(e,t)=>{let{rows:n,children:s}=e;const i="table"===t?n:s,l=[].slice.call(i).filter((e=>e.classList.contains("hidden"))).length;return 0!==l?` ${l}`:""},t=function(e,t){return void 0===t&&(t=!1),e.classList[t?"add":"remove"]("hidden")},n=(e,t)=>{for(let n in t)e.setAttribute(n,t[n])},s=e=>document.createElement(e),i={newLine:{match:/(\r\n|\n|\r)/gm,replace:""},space:{match:/\s\s+/gm,replace:" "},br:{match:/<br\s*\/?>/gim,replace:""},html:{match:/(<((?!b|\/b|!strong|\/strong)[^>]+)>)/gi,replace:""}},l={typeElement:"span",more:!1,less:!1,number:!1,nobutton:!1,after:0,btnClass:"show-more-btn",btnClassAppend:null};return class{constructor(e,t){let{onMoreLess:n=(()=>{}),regex:s={},config:r}=void 0===t?{}:t;const a=[].slice.call(document.querySelectorAll(e));this.t=n,this.i={...i,...s},a.map(((e,t)=>{const n=JSON.parse(e.getAttribute("data-config")),s={...r,...n};this.l={index:t,classArray:e.classList,...l,...s,typeElement:s.element||"span",element:e},this.o()}))}o=()=>{const{element:e,after:i,ellipsis:l,nobutton:r,limit:a,type:o}=this.l;n(e,{"aria-expanded":"false"});const c=a+i,h=!1===l?"":"...";if("text"===o){const t=e.innerHTML.trim();if(e.textContent.trim().length>c){let n=t;for(let e in this.i){const{match:t,replace:s}=this.i[e];e&&t&&(n=n.replace(t,s))}const i=((e,t)=>{let n=s("div");return n.insertAdjacentHTML("afterbegin",e),function e(t,n){let s=t.firstChild;do{3===s.nodeType?n(s):1===s.nodeType&&s.childNodes&&s.childNodes[0]&&e(s,n)}while(s=s.nextSibling)}(n,(function(e){if(t>0){let n=e.data.length;(t-=n)<=0&&(e.data=e.substringData(0,e.data.length+t))}else e.data=""})),n.innerHTML})(n,a-1).concat(h);if(e.textContent="",e.insertAdjacentHTML("beforeend",i),this.h(e,{...this.l,originalText:t,truncatedText:i}),r)return;this.p(this.l)}}if("list"===o||"table"===o){const n=this.m(e,o);if(n.length>c){for(let e=a;e<n.length;e++)t(n[e],!0);if(r||this.p(this.l),this.h("list"===o?e:e.nextElementSibling,this.l),r)return}}};h=(e,t)=>e.addEventListener("click",this.u.bind(this,t));g=t=>{let{element:i,number:l,less:r,more:a,type:o,btnClass:c,btnClassAppend:h}=t;const d=this._?r||"":a||"",f=this._?"collapse":"expand",p=!!this._,m=s("button");return m.className=null==h?c:c+" "+h,m.type="button",n(m,{"aria-expanded":p,"aria-label":f,tabindex:0}),m.insertAdjacentHTML("beforeend",l?d+e(i,o):d),m};u=(e,n)=>{let{target:i}=n;const{element:l,type:r,limit:a,less:o,typeElement:c,originalText:h,truncatedText:d,btnClass:f}=e,p=i.classList.contains(f);if(!p)return;const m=l.getAttribute("aria-expanded");if(this._="false"===m,"text"===r&&p&&(l.textContent="",l.insertAdjacentHTML("beforeend",this._?h:d),o)){const t=s(c);t.classList.add("show-more-wrapper"),t.insertAdjacentElement("beforeend",this.g(e)),l.appendChild(t)}if("list"===r||"table"===r){const e=this.m(l,r);for(let n=0;n<e.length;n++){const s="list"===r?n>=a&&n<e.length-1:n>=a;"false"===m?t(e[n]):s&&t(e[n],!0)}}r&&this.C({...e,target:i})};m=(e,t)=>"list"===t?[].slice.call(e.children):e.rows;p=e=>{const{type:t,element:n,more:i,typeElement:l}=e;if(i)if("table"===t)n.insertAdjacentElement("afterend",this.g(e));else{const t=s(l);t.classList.add("show-more-wrapper"),t.appendChild(this.g(e)),n.appendChild(t)}};C=t=>{const{element:s,type:i,less:l,more:r,number:a,target:o}=t,c=this._?l:r,h=this._?"expand":"collapse",d="table"===i?i:`the ${i}`,f=s.lastElementChild;n(s,{"aria-expanded":this._}),n(o,{"aria-expanded":this._,"aria-label":`${h} ${d}`}),this.t(h,t),c?o.innerHTML=a?c+e(s,i):c:"table"===i?o.parentNode.removeChild(o):"list"===i&&f.parentNode.removeChild(f)}}}));
